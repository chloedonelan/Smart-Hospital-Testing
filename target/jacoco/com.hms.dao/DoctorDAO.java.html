<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DoctorDAO.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Doctor-Patient-Portal Maven Webapp</a> &gt; <a href="index.source.html" class="el_package">com.hms.dao</a> &gt; <span class="el_source">DoctorDAO.java</span></div><h1>DoctorDAO.java</h1><pre class="source lang-java linenums">package com.hms.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

//import javax.security.auth.message.callback.PrivateKeyCallback.Request;
import jakarta.servlet.http.HttpSession;

import com.hms.entity.Doctor;

public class DoctorDAO {

	private Connection conn;

	public DoctorDAO(Connection conn) {
<span class="fc" id="L19">		super();</span>
<span class="fc" id="L20">		this.conn = conn;</span>
<span class="fc" id="L21">	}</span>

	public boolean registerDoctor(Doctor doctor) {

<span class="fc" id="L25">		boolean f = false;</span>

		try {

<span class="fc" id="L29">			String sql = &quot;insert into doctor(fullName,dateOfBirth,qualification,specialist,email,phone,password) values(?,?,?,?,?,?,?)&quot;;</span>

<span class="fc" id="L31">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>
<span class="fc" id="L32">			pstmt.setString(1, doctor.getFullName());</span>
<span class="fc" id="L33">			pstmt.setString(2, doctor.getDateOfBirth());</span>
<span class="fc" id="L34">			pstmt.setString(3, doctor.getQualification());</span>
<span class="fc" id="L35">			pstmt.setString(4, doctor.getSpecialist());</span>
<span class="fc" id="L36">			pstmt.setString(5, doctor.getEmail());</span>
<span class="fc" id="L37">			pstmt.setString(6, doctor.getPhone());</span>
<span class="fc" id="L38">			pstmt.setString(7, doctor.getPassword());</span>

<span class="fc" id="L40">			pstmt.executeUpdate();</span>
			// if query inserted or all ok than
<span class="fc" id="L42">			f = true;</span>

<span class="fc" id="L44">		} catch (Exception e) {</span>
<span class="fc" id="L45">			e.printStackTrace();</span>
<span class="fc" id="L46">		}</span>

<span class="fc" id="L48">		return f;</span>
	}

	// getAllDoctors list
	public List&lt;Doctor&gt; getAllDoctor() {

<span class="nc" id="L54">		Doctor doctor = null;</span>
<span class="nc" id="L55">		List&lt;Doctor&gt; docList = new ArrayList&lt;Doctor&gt;();</span>

		try {

<span class="nc" id="L59">			String sql = &quot;select * from doctor order by id desc&quot;;</span>
<span class="nc" id="L60">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>

<span class="nc" id="L62">			ResultSet resultSet = pstmt.executeQuery();</span>

<span class="nc bnc" id="L64" title="All 2 branches missed.">			while (resultSet.next()) {</span>
<span class="nc" id="L65">				doctor = new Doctor();</span>

<span class="nc" id="L67">				doctor.setId(resultSet.getInt(&quot;id&quot;));</span>
<span class="nc" id="L68">				doctor.setFullName(resultSet.getString(&quot;fullName&quot;));</span>
<span class="nc" id="L69">				doctor.setDateOfBirth(resultSet.getString(&quot;dateOfBirth&quot;));</span>
<span class="nc" id="L70">				doctor.setQualification(resultSet.getString(&quot;qualification&quot;));</span>
<span class="nc" id="L71">				doctor.setSpecialist(resultSet.getString(&quot;specialist&quot;));</span>
<span class="nc" id="L72">				doctor.setEmail(resultSet.getString(&quot;email&quot;));</span>
<span class="nc" id="L73">				doctor.setPhone(resultSet.getString(&quot;phone&quot;));</span>
<span class="nc" id="L74">				doctor.setPassword(resultSet.getString(&quot;password&quot;));</span>
<span class="nc" id="L75">				docList.add(doctor);</span>
			}

<span class="nc" id="L78">		} catch (Exception e) {</span>
<span class="nc" id="L79">			e.printStackTrace();</span>
<span class="nc" id="L80">		}</span>

<span class="nc" id="L82">		return docList;</span>
	}

	// get doctor by id
	public Doctor getDoctorById(int id) {

<span class="nc" id="L88">		Doctor doctor = null;</span>

		try {

<span class="nc" id="L92">			String sql = &quot;select * from doctor where id=?&quot;;</span>
<span class="nc" id="L93">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>
<span class="nc" id="L94">			pstmt.setInt(1, id);</span>

<span class="nc" id="L96">			ResultSet resultSet = pstmt.executeQuery();</span>

<span class="nc bnc" id="L98" title="All 2 branches missed.">			while (resultSet.next()) {</span>
<span class="nc" id="L99">				doctor = new Doctor();</span>

<span class="nc" id="L101">				doctor.setId(resultSet.getInt(&quot;id&quot;));</span>
<span class="nc" id="L102">				doctor.setFullName(resultSet.getString(&quot;fullName&quot;));</span>
<span class="nc" id="L103">				doctor.setDateOfBirth(resultSet.getString(&quot;dateOfBirth&quot;));</span>
<span class="nc" id="L104">				doctor.setQualification(resultSet.getString(&quot;qualification&quot;));</span>
<span class="nc" id="L105">				doctor.setSpecialist(resultSet.getString(&quot;specialist&quot;));</span>
<span class="nc" id="L106">				doctor.setEmail(resultSet.getString(&quot;email&quot;));</span>
<span class="nc" id="L107">				doctor.setPhone(resultSet.getString(&quot;phone&quot;));</span>
<span class="nc" id="L108">				doctor.setPassword(resultSet.getString(&quot;password&quot;));</span>

			}

<span class="nc" id="L112">		} catch (Exception e) {</span>
<span class="nc" id="L113">			e.printStackTrace();</span>
<span class="nc" id="L114">		}</span>

<span class="nc" id="L116">		return doctor;</span>
	}

	// update doctors by id
	public boolean updateDoctor(Doctor doctor) {

<span class="fc" id="L122">		boolean f = false;</span>

		try {

<span class="fc" id="L126">			String sql = &quot;update doctor set fullName=?,dateOfBirth=?,qualification=?,specialist=?,email=?,phone=?,password=? where id=?&quot;;</span>

<span class="fc" id="L128">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>
<span class="fc" id="L129">			pstmt.setString(1, doctor.getFullName());</span>
<span class="fc" id="L130">			pstmt.setString(2, doctor.getDateOfBirth());</span>
<span class="fc" id="L131">			pstmt.setString(3, doctor.getQualification());</span>
<span class="fc" id="L132">			pstmt.setString(4, doctor.getSpecialist());</span>
<span class="fc" id="L133">			pstmt.setString(5, doctor.getEmail());</span>
<span class="fc" id="L134">			pstmt.setString(6, doctor.getPhone());</span>
<span class="fc" id="L135">			pstmt.setString(7, doctor.getPassword());</span>
			// need to set id also for update
<span class="fc" id="L137">			pstmt.setInt(8, doctor.getId());</span>

<span class="fc" id="L139">			pstmt.executeUpdate();</span>
			// if query updated or all ok than
<span class="fc" id="L141">			f = true;</span>

<span class="fc" id="L143">		} catch (Exception e) {</span>
<span class="fc" id="L144">			e.printStackTrace();</span>
<span class="fc" id="L145">		}</span>

<span class="fc" id="L147">		return f;</span>
	}

	// delete doctors by id
	public boolean deleteDoctorById(int id) {

<span class="fc" id="L153">		boolean f = false;</span>

		try {

<span class="fc" id="L157">			String sql = &quot;delete from doctor where id=?&quot;;</span>
<span class="fc" id="L158">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>
<span class="fc" id="L159">			pstmt.setInt(1, id);</span>

<span class="fc" id="L161">			pstmt.executeUpdate();</span>

<span class="fc" id="L163">			f = true;</span>

<span class="nc" id="L165">		} catch (Exception e) {</span>
<span class="nc" id="L166">			e.printStackTrace();</span>
<span class="fc" id="L167">		}</span>

<span class="fc" id="L169">		return f;</span>
	}

	// doctor login
	public Doctor loginDoctor(String email, String password) {

<span class="nc" id="L175">		Doctor doctor = null;</span>

		try {

<span class="nc" id="L179">			String sql = &quot;select * from doctor where email=? and password=?&quot;;</span>
<span class="nc" id="L180">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>

<span class="nc" id="L182">			pstmt.setString(1, email);</span>
<span class="nc" id="L183">			pstmt.setString(2, password);</span>

<span class="nc" id="L185">			ResultSet resultSet = pstmt.executeQuery();</span>

<span class="nc bnc" id="L187" title="All 2 branches missed.">			while (resultSet.next()) {</span>
<span class="nc" id="L188">				doctor = new Doctor();</span>

				/*
				 * doctor.setId(resultSet.getInt(&quot;id&quot;));
				 * doctor.setFullName(resultSet.getString(&quot;fullName&quot;));
				 * doctor.setDateOfBirth(resultSet.getString(&quot;dateOfBirth&quot;));
				 * doctor.setQualification(resultSet.getString(&quot;qualification&quot;));
				 * doctor.setSpecialist(resultSet.getString(&quot;specialist&quot;));
				 * doctor.setEmail(resultSet.getString(&quot;email&quot;));
				 * doctor.setPhone(resultSet.getString(&quot;phone&quot;));
				 * doctor.setPassword(resultSet.getString(&quot;password&quot;));
				 */
				// we can write above commented code or
				// or
				// the below way [here 1 2 3..serially are the column index number of doctor
				// table]

<span class="nc" id="L205">				doctor.setId(resultSet.getInt(1));</span>
<span class="nc" id="L206">				doctor.setFullName(resultSet.getString(2));</span>
<span class="nc" id="L207">				doctor.setDateOfBirth(resultSet.getString(3));</span>
<span class="nc" id="L208">				doctor.setQualification(resultSet.getString(4));</span>
<span class="nc" id="L209">				doctor.setSpecialist(resultSet.getString(5));</span>
<span class="nc" id="L210">				doctor.setEmail(resultSet.getString(6));</span>
<span class="nc" id="L211">				doctor.setPhone(resultSet.getString(7));</span>
<span class="nc" id="L212">				doctor.setPassword(resultSet.getString(8));</span>

			}

<span class="nc" id="L216">		} catch (Exception e) {</span>
<span class="nc" id="L217">			e.printStackTrace();</span>
<span class="nc" id="L218">		}</span>

<span class="nc" id="L220">		return doctor;</span>

	}

	// show total number of dynamic value in admin panel

	// create all count method here to reduce code line...
	// Count total Doctor Number
	public int countTotalDoctor() {

<span class="nc" id="L230">		int i = 0;</span>

		try {

<span class="nc" id="L234">			String sql = &quot;select * from doctor&quot;;</span>
<span class="nc" id="L235">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>

<span class="nc" id="L237">			ResultSet resultSet = pstmt.executeQuery();</span>
<span class="nc bnc" id="L238" title="All 2 branches missed.">			while (resultSet.next()) {</span>

<span class="nc" id="L240">				i++;</span>
			}

<span class="nc" id="L243">		} catch (Exception e) {</span>
<span class="nc" id="L244">			e.printStackTrace();</span>
<span class="nc" id="L245">		}</span>

<span class="nc" id="L247">		return i;</span>
	}

	// Count total Appointment Number
	public int countTotalAppointment() {

<span class="nc" id="L253">		int i = 0;</span>

		try {

<span class="nc" id="L257">			String sql = &quot;select * from appointment&quot;;</span>
<span class="nc" id="L258">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>

<span class="nc" id="L260">			ResultSet resultSet = pstmt.executeQuery();</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">			while (resultSet.next()) {</span>

<span class="nc" id="L263">				i++;</span>
			}

<span class="nc" id="L266">		} catch (Exception e) {</span>
<span class="nc" id="L267">			e.printStackTrace();</span>
<span class="nc" id="L268">		}</span>

<span class="nc" id="L270">		return i;</span>
	}

	// Count total number of Appointment for a specific doctor
	public int countTotalAppointmentByDoctorId(int doctorId) {

<span class="nc" id="L276">		int i = 0;</span>

		try {

<span class="nc" id="L280">			String sql = &quot;select * from appointment where doctorId=?&quot;;</span>
<span class="nc" id="L281">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>
<span class="nc" id="L282">			pstmt.setInt(1, doctorId);</span>

<span class="nc" id="L284">			ResultSet resultSet = pstmt.executeQuery();</span>
<span class="nc bnc" id="L285" title="All 2 branches missed.">			while (resultSet.next()) {</span>

<span class="nc" id="L287">				i++;</span>
			}

<span class="nc" id="L290">		} catch (Exception e) {</span>
<span class="nc" id="L291">			e.printStackTrace();</span>
<span class="nc" id="L292">		}</span>

<span class="nc" id="L294">		return i;</span>
	}

	// Count total User Number
	public int countTotalUser() {

<span class="nc" id="L300">		int i = 0;</span>

		try {

<span class="nc" id="L304">			String sql = &quot;select * from user_details&quot;;</span>
<span class="nc" id="L305">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>

<span class="nc" id="L307">			ResultSet resultSet = pstmt.executeQuery();</span>
<span class="nc bnc" id="L308" title="All 2 branches missed.">			while (resultSet.next()) {</span>

<span class="nc" id="L310">				i++;</span>
			}

<span class="nc" id="L313">		} catch (Exception e) {</span>
<span class="nc" id="L314">			e.printStackTrace();</span>
<span class="nc" id="L315">		}</span>

<span class="nc" id="L317">		return i;</span>
	}

	// Count total Specialist Number
	public int countTotalSpecialist() {

<span class="nc" id="L323">		int i = 0;</span>

		try {

<span class="nc" id="L327">			String sql = &quot;select * from specialist&quot;;</span>
<span class="nc" id="L328">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>

<span class="nc" id="L330">			ResultSet resultSet = pstmt.executeQuery();</span>
<span class="nc bnc" id="L331" title="All 2 branches missed.">			while (resultSet.next()) {</span>

<span class="nc" id="L333">				i++;</span>
			}

<span class="nc" id="L336">		} catch (Exception e) {</span>
<span class="nc" id="L337">			e.printStackTrace();</span>
<span class="nc" id="L338">		}</span>

<span class="nc" id="L340">		return i;</span>
	}

	// check old password
	public boolean checkOldPassword(int doctorId, String oldPassword) {

<span class="nc" id="L346">		boolean f = false;</span>

		try {

<span class="nc" id="L350">			String sql = &quot;select * from doctor where id=? and password=?&quot;;</span>
<span class="nc" id="L351">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>
<span class="nc" id="L352">			pstmt.setInt(1, doctorId);</span>
<span class="nc" id="L353">			pstmt.setString(2, oldPassword);</span>

<span class="nc" id="L355">			ResultSet resultSet = pstmt.executeQuery();</span>

<span class="nc bnc" id="L357" title="All 2 branches missed.">			while (resultSet.next()) {</span>
<span class="nc" id="L358">				f = true;</span>
			}

<span class="nc" id="L361">		} catch (Exception e) {</span>
<span class="nc" id="L362">			e.printStackTrace();</span>
<span class="nc" id="L363">		}</span>

<span class="nc" id="L365">		return f;</span>
	}

	// change password
	public boolean changePassword(int doctorId, String newPassword) {

<span class="nc" id="L371">		boolean f = false;</span>

		try {

<span class="nc" id="L375">			String sql = &quot;update doctor set password=? where id=?&quot;;</span>
<span class="nc" id="L376">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>
<span class="nc" id="L377">			pstmt.setString(1, newPassword);</span>
<span class="nc" id="L378">			pstmt.setInt(2, doctorId);</span>

<span class="nc" id="L380">			pstmt.executeUpdate();</span>

<span class="nc" id="L382">			f = true;</span>

<span class="nc" id="L384">		} catch (Exception e) {</span>
<span class="nc" id="L385">			e.printStackTrace();</span>
<span class="nc" id="L386">		}</span>

<span class="nc" id="L388">		return f;</span>
	}

	// edit doctor profile in doctor panel edit profile
	public boolean editDoctorProfile(Doctor doctor) {

<span class="nc" id="L394">		boolean f = false;</span>

		try {

			//String sql = &quot;update doctor set fullName=?,dateOfBirth=?,qualification=?,specialist=?,email=?,phone=?,password=? where id=?&quot;;
<span class="nc" id="L399">			String sql = &quot;update doctor set fullName=?,dateOfBirth=?,qualification=?,specialist=?,email=?,phone=? where id=?&quot;;</span>

<span class="nc" id="L401">			PreparedStatement pstmt = this.conn.prepareStatement(sql);</span>
<span class="nc" id="L402">			pstmt.setString(1, doctor.getFullName());</span>
<span class="nc" id="L403">			pstmt.setString(2, doctor.getDateOfBirth());</span>
<span class="nc" id="L404">			pstmt.setString(3, doctor.getQualification());</span>
<span class="nc" id="L405">			pstmt.setString(4, doctor.getSpecialist());</span>
<span class="nc" id="L406">			pstmt.setString(5, doctor.getEmail());</span>
<span class="nc" id="L407">			pstmt.setString(6, doctor.getPhone());</span>
			//pstmt.setString(7, doctor.getPassword());
			// need to set id also for update
<span class="nc" id="L410">			pstmt.setInt(7, doctor.getId());</span>

<span class="nc" id="L412">			pstmt.executeUpdate();</span>
			// if query updated or all okay than
<span class="nc" id="L414">			f = true;</span>

<span class="nc" id="L416">		} catch (Exception e) {</span>
<span class="nc" id="L417">			e.printStackTrace();</span>
<span class="nc" id="L418">		}</span>

<span class="nc" id="L420">		return f;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>